#message(STATUS "wls_llvm_tools_gold: 1 LLVM_ENABLE_PIC=${LLVM_ENABLE_PIC} LLVM_BINUTILS_INCDIR=${LLVM_BINUTILS_INCDIR}")
set(LLVM_EXPORTED_SYMBOL_FILE ${CMAKE_CURRENT_SOURCE_DIR}/gold.exports)

if( LLVM_ENABLE_PIC AND LLVM_BINUTILS_INCDIR )
#message(STATUS "wls_llvm_tools_gold: 2 CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR} LLVM_ENABLE_PIC=${LLVM_ENABLE_PIC} LLVM_BINUTILS_INCDIR=${LLVM_BINUTILS_INCDIR} LLVM_TARGETS_TO_BUILD=${LLVM_TARGETS_TO_BUILD}")
  include_directories( ${LLVM_BINUTILS_INCDIR} )

  set(LLVM_LINK_COMPONENTS
     ${LLVM_TARGETS_TO_BUILD}
     Linker
     LTO
     BitWriter
     IPO
     )

  add_llvm_library(LLVMgold MODULE
    gold-plugin.cpp
    PLUGIN_TOOL LLVM
    )

  #message(STATUS "wls_llvm_tools_gold: 2.99 CMAKE_CURRENT_SOURCE_DIR=${CMAKE_CURRENT_SOURCE_DIR} LLVM_ENABLE_PIC=${LLVM_ENABLE_PIC} LLVM_BINUTILS_INCDIR=${LLVM_BINUTILS_INCDIR} LLVM_TARGETS_TO_BUILD=${LLVM_TARGETS_TO_BUILD}")
endif()
